<?xml version="1.0" encoding="utf-8"?>

<controls:Popup xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:controls="clr-namespace:ChecklistApp.Controls"
             xmlns:model="clr-namespace:ChecklistApp.Model"
             x:Name="CreateItem"
             x:Class="ChecklistApp.Controls.CreateItemPopup">
    <Grid BindingContext="{x:Reference CreateItem}" 
          RowDefinitions="*,70">
        <CollectionView ItemsSource="{Binding Items}">
            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="model:Item">
                    <Grid Margin="10,10,10,0"
                          HeightRequest="50"
                          ColumnDefinitions="*,50"
                          ColumnSpacing="10">

                        <controls:RoundedEntry Text="{Binding Name}" 
                                               Placeholder="Item Name" 
                                               Grid.Column="0" />
                        <Button Grid.Column="1" 
                                FontFamily="FontAwSolid" 
                                Text="&#xf1f8;" 
                                Background="{StaticResource ForegroundRedBrush}"
                                Command="{Binding Source={RelativeSource AncestorType={x:Type controls:CreateItemPopup}}, Path=DeleteCommand}"
                                CommandParameter="{Binding .}"/>
                    </Grid>
                </DataTemplate>
            </CollectionView.ItemTemplate>
            
            <CollectionView.Footer>
                <Button Text="New Item"
                        Command="{Binding AddCommand}"
                        HeightRequest="50"
                        Margin="10" />
            </CollectionView.Footer>
        </CollectionView>
        <controls:ControlBar Grid.Row="1">
            <Grid ColumnDefinitions="50,*"
                  ColumnSpacing="10">
                <Button FontFamily="FontAwSolid"
                        Text="&#xf060;"
                        Clicked="BackButtonClicked" />
                <Button Grid.Column="1"
                        Text="Save"
                        Clicked="SaveButtonClicked" />
            </Grid>
        </controls:ControlBar>
    </Grid>
</controls:Popup>